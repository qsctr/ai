<h1 id="perceptron">Perceptron</h1>
<p>See the source code on GitHub: <a href="https://github.com/qsctr/simple-perceptron">https://github.com/qsctr/simple-perceptron</a></p>
<h2 id="3-23-2017">3/23/2017</h2>
<p>This is the first project about machine learning. Perceptron is basically a function which takes some inputs and returns an output. The inputs are multiplied with weights and the sum is checked against a threshold. The goal of the Perceptron is to learn the weights and threshold from a training set of data.</p>
<p>For this project the task of the Perceptron was to divide two sets of points on a plane. So the Perceptron takes two inputs, the x and y coordinates of the point. The Perceptron can be graphed as a line on the plane, with the threshold divided by the x weight as the x intercept, and the threshold divided by the y weight as the y intercept. The goal is to make an animation of the Perceptron so that you can see it learning the weights and fitting the data in real time.</p>
<p>I did this project in the Haskell programming language. I defined a data type called <code>Perceptron</code> to hold information related to the Perceptron.</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token keyword">data</span> <span class="token constant">Perceptron</span> <span class="token operator">=</span> <span class="token constant">Perceptron</span> <span class="token punctuation">{</span> <span class="token hvariable">weights</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token constant">Float</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token hvariable">threshold</span> <span class="token operator">::</span> <span class="token constant">Float</span><span class="token punctuation">,</span> <span class="token hvariable">rate</span> <span class="token operator">::</span> <span class="token constant">Float</span> <span class="token punctuation">}</span>
</code></pre>
<p>Here is the activate function for the Perceptron.</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">activate</span> <span class="token operator">::</span> <span class="token constant">Perceptron</span> <span class="token operator">-></span> <span class="token punctuation">[</span><span class="token constant">Float</span><span class="token punctuation">]</span> <span class="token operator">-></span> <span class="token constant">Float</span>
<span class="token hvariable">activate</span> <span class="token constant">Perceptron</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token builtin">fromIntegral</span><span class="token operator"> . </span><span class="token builtin">fromEnum</span><span class="token operator"> . </span><span class="token punctuation">(</span><span class="token operator">></span> <span class="token hvariable">threshold</span><span class="token punctuation">)</span><span class="token operator"> . </span><span class="token builtin">sum</span><span class="token operator"> . </span><span class="token builtin">zipWith</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token hvariable">weights</span>
</code></pre>
<p>However, I also wrote a logistic function, which makes the Perceptron appear smoother in the animation, and also makes it divide the points at the center instead of stopping once it works correctly.</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">activate</span> <span class="token constant">Perceptron</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span><span class="token punctuation">)</span><span class="token operator"> . </span><span class="token builtin">succ</span><span class="token operator"> . </span><span class="token builtin">exp</span><span class="token operator"> . </span><span class="token builtin">negate</span><span class="token operator"> . </span><span class="token builtin">subtract</span> <span class="token hvariable">threshold</span><span class="token operator"> . </span><span class="token builtin">sum</span><span class="token operator"> . </span><span class="token builtin">zipWith</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token hvariable">weights</span>
</code></pre>
<p>And here is the learning function.</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">learn</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">Float</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token constant">Perceptron</span> <span class="token operator">-></span> <span class="token constant">Perceptron</span>
<span class="token hvariable">learn</span> <span class="token punctuation">(</span><span class="token hvariable">inputs</span><span class="token punctuation">,</span> <span class="token hvariable">target</span><span class="token punctuation">)</span> <span class="token constant">Perceptron</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token constant">Perceptron</span>
    <span class="token punctuation">{</span> <span class="token hvariable">weights</span> <span class="token operator">=</span> <span class="token builtin">zipWith</span> <span class="token hvariable">learnWeight</span> <span class="token hvariable">weights</span> <span class="token hvariable">inputs</span>
    <span class="token punctuation">,</span> <span class="token hvariable">threshold</span> <span class="token operator">=</span> <span class="token hvariable">learnWeight</span> <span class="token hvariable">threshold</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">,</span> <span class="token operator">..</span> <span class="token punctuation">}</span>
    <span class="token keyword">where</span>
    <span class="token hvariable">learnWeight</span> <span class="token hvariable">weight</span> <span class="token hvariable">input</span> <span class="token operator">=</span>
        <span class="token hvariable">weight</span> <span class="token operator">+</span> <span class="token hvariable">rate</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token builtin">fromIntegral</span> <span class="token hvariable">target</span> <span class="token operator">-</span> <span class="token hvariable">activate</span> <span class="token constant">Perceptron</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">}</span> <span class="token hvariable">inputs</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">input</span>
</code></pre>
<p>As you can see, the threshold can be treated as a weight with the input always at -1.</p>
<p>Even though in this project I am only using two inputs, the Perceptron functions here can handle any number of inputs.</p>
