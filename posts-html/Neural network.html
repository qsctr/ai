<h1 id="neural-network">Neural network</h1>
<p>See the source code on GitHub: <a href="https://github.com/qsctr/neural-network">https://github.com/qsctr/neural-network</a>, <a href="https://github.com/qsctr/neural-network-classify">https://github.com/qsctr/neural-network-classify</a></p>
<h2 id="5-19-2017">5/19/2017</h2>
<p>For my semester 2 final project I decided to write my own feed-forward neural network in Haskell. I think the hardest part was writing the backpropagation algorithm. Here is the code that trains the neural network.</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">train</span> <span class="token operator">::</span> <span class="token constant">ActivationFns</span> <span class="token operator">-></span> <span class="token constant">Double</span> <span class="token operator">-></span> <span class="token constant">TrainingSample</span> <span class="token operator">-></span> <span class="token constant">Network</span> <span class="token operator">-></span> <span class="token punctuation">(</span><span class="token constant">Network</span><span class="token punctuation">,</span> <span class="token constant">Double</span><span class="token punctuation">)</span>
<span class="token hvariable">train</span> <span class="token punctuation">(</span><span class="token hvariable">g</span><span class="token punctuation">,</span> <span class="token hvariable">g</span>'<span class="token punctuation">)</span> <span class="token hvariable">r</span> <span class="token punctuation">(</span><span class="token hvariable">is</span><span class="token punctuation">,</span> <span class="token hvariable">ts</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">checkNet</span> <span class="token operator">-></span> <span class="token hvariable">net</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">snd</span> <span class="token operator">$</span> <span class="token hvariable">bProp</span> <span class="token hvariable">is</span> <span class="token hvariable">net</span> <span class="token hvariable">oss</span><span class="token punctuation">,</span> <span class="token hvariable">err</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span> <span class="token hvariable">err</span> <span class="token operator">=</span> <span class="token builtin">sum</span> <span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token hvariable">t</span> <span class="token operator">-</span> <span class="token hvariable">o</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token hvariable">t</span> <span class="token operator">&lt;-</span> <span class="token hvariable">ts</span> <span class="token operator">|</span> <span class="token hvariable">o</span> <span class="token operator">&lt;-</span> <span class="token builtin">fst</span> <span class="token operator">$</span> <span class="token builtin">last</span> <span class="token hvariable">oss</span> <span class="token punctuation">]</span>
        <span class="token hvariable">oss</span> <span class="token operator">=</span> <span class="token hvariable">fProp</span> <span class="token hvariable">is</span> <span class="token hvariable">net</span>
        <span class="token hvariable">fProp</span> <span class="token hvariable">_</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token hvariable">fProp</span> <span class="token hvariable">is</span>' <span class="token punctuation">(</span><span class="token hvariable">l</span><span class="token operator">:</span><span class="token hvariable">ls</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">os</span><span class="token punctuation">,</span> <span class="token builtin">map</span> <span class="token hvariable">g</span>' <span class="token hvariable">nis</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token hvariable">fProp</span> <span class="token hvariable">os</span> <span class="token hvariable">ls</span>
          <span class="token keyword">where</span> <span class="token hvariable">nis</span> <span class="token operator">=</span> <span class="token hvariable">netInputs</span> <span class="token hvariable">is</span>' <span class="token hvariable">l</span>
                <span class="token hvariable">os</span> <span class="token operator">=</span> <span class="token builtin">map</span> <span class="token hvariable">g</span> <span class="token hvariable">nis</span>
        <span class="token hvariable">bProp</span> <span class="token hvariable">is</span>' <span class="token punctuation">[</span><span class="token hvariable">l</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token hvariable">os</span><span class="token punctuation">,</span> <span class="token hvariable">os</span>'<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">ds</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token hvariable">update</span> <span class="token hvariable">is</span>' <span class="token hvariable">l</span> <span class="token hvariable">ds</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token keyword">where</span> <span class="token hvariable">ds</span> <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token hvariable">o</span>' <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">t</span> <span class="token operator">-</span> <span class="token hvariable">o</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">o</span> <span class="token operator">&lt;-</span> <span class="token hvariable">os</span> <span class="token operator">|</span> <span class="token hvariable">o</span>' <span class="token operator">&lt;-</span> <span class="token hvariable">os</span>' <span class="token operator">|</span> <span class="token hvariable">t</span> <span class="token operator">&lt;-</span> <span class="token hvariable">ts</span> <span class="token punctuation">]</span>
        <span class="token hvariable">bProp</span> <span class="token hvariable">is</span>' <span class="token punctuation">(</span><span class="token hvariable">cl</span><span class="token operator">:</span><span class="token hvariable">nl</span><span class="token operator">:</span><span class="token hvariable">ls</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">os</span><span class="token punctuation">,</span> <span class="token hvariable">os</span>'<span class="token punctuation">)</span><span class="token operator">:</span><span class="token hvariable">oss</span>'<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">cds</span><span class="token punctuation">,</span> <span class="token hvariable">update</span> <span class="token hvariable">is</span>' <span class="token hvariable">cl</span> <span class="token hvariable">cds</span> <span class="token operator">:</span> <span class="token hvariable">net</span>'<span class="token punctuation">)</span>
          <span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token hvariable">pds</span><span class="token punctuation">,</span> <span class="token hvariable">net</span>'<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">bProp</span> <span class="token hvariable">os</span> <span class="token punctuation">(</span><span class="token hvariable">nl</span><span class="token operator">:</span><span class="token hvariable">ls</span><span class="token punctuation">)</span> <span class="token hvariable">oss</span>'
                <span class="token hvariable">cds</span> <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token hvariable">o</span>' <span class="token operator">*</span> <span class="token builtin">sum</span> <span class="token punctuation">[</span> <span class="token hvariable">ws</span> <span class="token operator">!!</span> <span class="token hvariable">i</span> <span class="token operator">*</span> <span class="token hvariable">pd</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token hvariable">ws</span><span class="token punctuation">,</span> <span class="token hvariable">_</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> <span class="token hvariable">nl</span> <span class="token operator">|</span> <span class="token hvariable">pd</span> <span class="token operator">&lt;-</span> <span class="token hvariable">pds</span> <span class="token punctuation">]</span>
                    <span class="token operator">|</span> <span class="token hvariable">o</span>' <span class="token operator">&lt;-</span> <span class="token hvariable">os</span>' <span class="token operator">|</span> <span class="token hvariable">i</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">..</span><span class="token punctuation">]</span> <span class="token punctuation">]</span>
        <span class="token hvariable">bProp</span> <span class="token hvariable">_</span> <span class="token hvariable">_</span> <span class="token hvariable">_</span> <span class="token operator">=</span> <span class="token builtin">undefined</span>
        <span class="token hvariable">update</span> <span class="token hvariable">is</span>' <span class="token hvariable">l</span> <span class="token hvariable">ds</span> <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token builtin">zipWith</span> <span class="token hvariable">wUpdate</span> <span class="token hvariable">ws</span> <span class="token hvariable">is</span>'<span class="token punctuation">,</span> <span class="token hvariable">wUpdate</span> <span class="token hvariable">b</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token hvariable">ws</span><span class="token punctuation">,</span> <span class="token hvariable">b</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span> <span class="token hvariable">l</span> <span class="token operator">|</span> <span class="token hvariable">d</span> <span class="token operator">&lt;-</span> <span class="token hvariable">ds</span><span class="token punctuation">,</span> <span class="token keyword">let</span> <span class="token hvariable">wUpdate</span> <span class="token hvariable">w</span> <span class="token hvariable">i</span> <span class="token operator">=</span> <span class="token hvariable">w</span> <span class="token operator">+</span> <span class="token hvariable">r</span> <span class="token operator">*</span> <span class="token hvariable">i</span> <span class="token operator">*</span> <span class="token hvariable">d</span> <span class="token punctuation">]</span>
</code></pre>
<p>I also modified my perceptron project to use a neural network, so there can be multiple lines on the screen, and it can classify non-linear inputs such as xor.</p>
