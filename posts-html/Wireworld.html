<h1 id="wireworld">Wireworld</h1>
<p>See the source code on GitHub: <a href="https://github.com/qsctr/wireworld">https://github.com/qsctr/wireworld</a></p>
<p>Wikipedia article on Wireworld: <a href="https://en.wikipedia.org/wiki/Wireworld">https://en.wikipedia.org/wiki/Wireworld</a></p>
<h2 id="8-21-2016-">8/21/2016:</h2>
<p>Since Wireworld is very similar to the Game of Life, to begin with I copied the Game of Life code and changed everywhere where it said &quot;Game of Life&quot; to &quot;Wireworld&quot;.</p>
<p>In Wireworld, each cell has 2 pieces of information: its location, and its type. In the Game of Life each alive cell only had a location, all alive cells were the same type. So, I changed the definition of <code>World</code> so that <code>cells</code> was is a list of pairs, with the first item being the <code>CellType</code> and the second being the location, which was another pair of <code>Int</code>s.</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token keyword">data</span> <span class="token constant">World</span> <span class="token operator">=</span> <span class="token constant">World</span> <span class="token punctuation">{</span> <span class="token hvariable">cells</span> <span class="token operator">::</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">CellType</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">Int</span><span class="token punctuation">,</span> <span class="token constant">Int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token hvariable">playing</span> <span class="token operator">::</span> <span class="token constant">Bool</span><span class="token punctuation">,</span> <span class="token hvariable">viewPort</span> <span class="token operator">::</span> <span class="token constant">ViewPort</span> <span class="token punctuation">}</span>
</code></pre>
<p><code>CellType</code> is defined as</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token keyword">data</span> <span class="token constant">CellType</span> <span class="token operator">=</span> <span class="token constant">EHead</span> <span class="token operator">|</span> <span class="token constant">ETail</span> <span class="token operator">|</span> <span class="token constant">Conductor</span> <span class="token keyword">deriving</span> <span class="token punctuation">(</span><span class="token constant">Eq</span><span class="token punctuation">)</span>
</code></pre>
<p>There is no need for the <code>Empty</code> type because then the cell wouldn&#39;t be in the list of alive cells in the first place.</p>
<p>For the <code>drawCell</code> function in <code>drawWorld</code>, the cell is drawn with different colors depending on its type.</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">drawCell</span> <span class="token punctuation">(</span><span class="token hvariable">cellType</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">y</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">color</span> <span class="token hvariable">c</span> <span class="token operator">$</span> <span class="token hvariable">translate</span> <span class="token punctuation">(</span><span class="token builtin">fromIntegral</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">fromIntegral</span> <span class="token hvariable">y</span><span class="token punctuation">)</span> <span class="token operator">$</span> <span class="token hvariable">rectangleSolid</span> <span class="token number">1</span> <span class="token number">1</span>
    <span class="token keyword">where</span> <span class="token hvariable">c</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token hvariable">cellType</span> <span class="token keyword">of</span>
              <span class="token constant">EHead</span> <span class="token operator">-></span> <span class="token hvariable">blue</span>
              <span class="token constant">ETail</span> <span class="token operator">-></span> <span class="token hvariable">red</span>
              <span class="token constant">Conductor</span> <span class="token operator">-></span> <span class="token hvariable">yellow</span>
</code></pre>
<p>Because there are different rules for Wireworld, the code for <code>stepWorld</code> (when the game isn&#39;t paused) is different.</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">stepWorld</span> <span class="token hvariable">_</span> <span class="token hvariable">world</span><span class="token operator">@</span><span class="token constant">World</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token hvariable">world</span> <span class="token punctuation">{</span> <span class="token hvariable">cells</span> <span class="token operator">=</span> <span class="token builtin">map</span> <span class="token hvariable">stepCell</span> <span class="token hvariable">cells</span> <span class="token punctuation">}</span>
    <span class="token keyword">where</span> <span class="token hvariable">stepCell</span> <span class="token punctuation">(</span><span class="token constant">EHead</span><span class="token punctuation">,</span> <span class="token hvariable">pos</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">ETail</span><span class="token punctuation">,</span> <span class="token hvariable">pos</span><span class="token punctuation">)</span>
          <span class="token hvariable">stepCell</span> <span class="token punctuation">(</span><span class="token constant">ETail</span><span class="token punctuation">,</span> <span class="token hvariable">pos</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">Conductor</span><span class="token punctuation">,</span> <span class="token hvariable">pos</span><span class="token punctuation">)</span>
          <span class="token hvariable">stepCell</span> <span class="token punctuation">(</span><span class="token constant">Conductor</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">y</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token operator">|</span> <span class="token hvariable">surroundingEHeadsCount</span> `<span class="token builtin">elem</span>` <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">EHead</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">y</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">Conductor</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span> <span class="token hvariable">y</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token keyword">where</span> <span class="token hvariable">surroundingEHeadsCount</span> <span class="token operator">=</span> <span class="token builtin">length</span> <span class="token operator">$</span> <span class="token hvariable">getEHeadsAt</span> <span class="token punctuation">[</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token hvariable">w</span><span class="token punctuation">,</span> <span class="token hvariable">y</span> <span class="token operator">+</span> <span class="token hvariable">h</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token hvariable">w</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token hvariable">h</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">]</span>
          <span class="token hvariable">getEHeadsAt</span> <span class="token operator">=</span> <span class="token builtin">foldr</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">pos</span> <span class="token hvariable">acc</span> <span class="token operator">-></span> <span class="token keyword">case</span> <span class="token hvariable">find</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">==</span> <span class="token hvariable">pos</span><span class="token punctuation">)</span><span class="token operator"> . </span><span class="token builtin">snd</span><span class="token punctuation">)</span> <span class="token hvariable">cells</span> <span class="token keyword">of</span>
              <span class="token constant">Just</span> <span class="token hvariable">cell</span> <span class="token operator">-></span> <span class="token keyword">if</span> <span class="token builtin">fst</span> <span class="token hvariable">cell</span> <span class="token operator">==</span> <span class="token constant">EHead</span> <span class="token keyword">then</span> <span class="token hvariable">cell</span> <span class="token operator">:</span> <span class="token hvariable">acc</span> <span class="token keyword">else</span> <span class="token hvariable">acc</span>
              <span class="token constant">Nothing</span> <span class="token operator">-></span> <span class="token hvariable">acc</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre>
<p>Because no dead cells become alive and vice versa, I no longer have to check if each surrounding cell should be alive or dead. However I do have to check the new type of each cell.</p>
<p>In <code>handleInput</code>, the code for the mouse button events is different. Now, when the left button is pressed, it switches between alive and dead, and when the right button is pressed, it changes the type of the cell.</p>
<pre class="language-haskell"><code class="language-haskell"><span class="token hvariable">handleInput</span> <span class="token punctuation">(</span><span class="token constant">EventKey</span> <span class="token punctuation">(</span><span class="token constant">MouseButton</span> <span class="token hvariable">button</span><span class="token punctuation">)</span> <span class="token constant">Down</span> <span class="token hvariable">_</span> <span class="token hvariable">coords</span><span class="token punctuation">)</span> <span class="token hvariable">world</span><span class="token operator">@</span><span class="token constant">World</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token hvariable">button</span> <span class="token operator">==</span> <span class="token constant">LeftButton</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token hvariable">findCell</span> <span class="token keyword">of</span>
        <span class="token constant">Just</span> <span class="token hvariable">cell</span> <span class="token operator">-></span> <span class="token hvariable">world</span> <span class="token punctuation">{</span> <span class="token hvariable">cells</span> <span class="token operator">=</span> <span class="token hvariable">delete</span> <span class="token hvariable">cell</span> <span class="token hvariable">cells</span> <span class="token punctuation">}</span>
        <span class="token constant">Nothing</span> <span class="token operator">-></span> <span class="token hvariable">world</span> <span class="token punctuation">{</span> <span class="token hvariable">cells</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">Conductor</span><span class="token punctuation">,</span> <span class="token hvariable">pos</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token hvariable">cells</span> <span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token hvariable">button</span> <span class="token operator">==</span> <span class="token constant">RightButton</span> <span class="token operator">=</span> <span class="token keyword">case</span> <span class="token hvariable">findCell</span> <span class="token keyword">of</span>
        <span class="token constant">Just</span> <span class="token hvariable">cell</span> <span class="token operator">-></span> <span class="token hvariable">world</span> <span class="token punctuation">{</span> <span class="token hvariable">cells</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">nextType</span> <span class="token operator">$</span> <span class="token builtin">fst</span> <span class="token hvariable">cell</span><span class="token punctuation">,</span> <span class="token hvariable">pos</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token hvariable">delete</span> <span class="token hvariable">cell</span> <span class="token hvariable">cells</span> <span class="token punctuation">}</span>
        <span class="token constant">Nothing</span> <span class="token operator">-></span> <span class="token hvariable">world</span>
    <span class="token keyword">where</span> <span class="token hvariable">findCell</span> <span class="token operator">=</span> <span class="token hvariable">find</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">==</span> <span class="token hvariable">pos</span><span class="token punctuation">)</span><span class="token operator"> . </span><span class="token builtin">snd</span><span class="token punctuation">)</span> <span class="token hvariable">cells</span>
          <span class="token hvariable">pos</span> <span class="token operator">=</span> <span class="token hvariable">mapPair</span> <span class="token builtin">round</span> <span class="token operator">$</span> <span class="token hvariable">invertViewPort</span> <span class="token hvariable">viewPort</span> <span class="token hvariable">coords</span>
          <span class="token hvariable">nextType</span> <span class="token constant">EHead</span> <span class="token operator">=</span> <span class="token constant">ETail</span>
          <span class="token hvariable">nextType</span> <span class="token constant">ETail</span> <span class="token operator">=</span> <span class="token constant">Conductor</span>
          <span class="token hvariable">nextType</span> <span class="token constant">Conductor</span> <span class="token operator">=</span> <span class="token constant">EHead</span>
</code></pre>
<p>I also changed the background to be black instead of white.</p>
<p>That is all of the changes. Most of the code is still the same as Game of Life. It has the same functionality, so the grid is infinite, the viewport is zoomable and movable, etc.</p>
